{"ast":null,"code":"import{useNavigate,useSearchParams}from\"react-router-dom\";import styles from\"./Map.module.css\";import\"leaflet/dist/leaflet.css\";import L from\"leaflet\";import{MapContainer,TileLayer,Marker,Popup,useMap,useMapEvents}from\"react-leaflet\";import{useEffect,useState}from\"react\";import{useCities}from\"../contexts/CitiesContext\";import markerIcon2x from\"leaflet/dist/images/marker-icon-2x.png\";// import { useMap } from \"react-leaflet\";\nimport{useGeolocation}from\"../hooks/useGeolocation\";import{useUrlPosition}from\"../hooks/useUrlPosition\";import Button from\"./Button\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Map(){const navigate=useNavigate();const[mapPosition,setMapPosition]=useState([40,0]);const{cities}=useCities();const[searchParams,setSearchParams]=useSearchParams();const{isLoading:isLoadingPosition,position:geolocationPosition,getPosition}=useGeolocation();const[mapLat,mapLng]=useUrlPosition();useEffect(function(){if(mapLat&&mapLng)setMapPosition([mapLat,mapLng]);},[mapLat,mapLng]);useEffect(function(){if(geolocationPosition){setMapPosition(geolocationPosition);}},[geolocationPosition]);return/*#__PURE__*/_jsxs(\"div\",{className:styles.mapContainer,children:[!geolocationPosition&&/*#__PURE__*/_jsx(Button,{type:\"position\",onClick:getPosition,children:isLoadingPosition?\"Loading...\":\"Use your Location\"}),/*#__PURE__*/_jsxs(MapContainer// center={[mapLat ? mapLat : 0, mapLng ? mapLng : 0]}\n,{center:mapPosition,zoom:13,scrollWheelZoom:true,className:styles.map,children:[/*#__PURE__*/_jsx(TileLayer,{attribution:\"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",url:\"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png\"}),cities.map(city=>/*#__PURE__*/_jsx(Marker,{position:[city.position?city.position.lat:0,city.position?city.position.lng:0],children:/*#__PURE__*/_jsxs(Popup,{children:[/*#__PURE__*/_jsx(\"span\",{children:city.emoji}),\" \",/*#__PURE__*/_jsx(\"span\",{children:city.cityName})]})},city.id)),/*#__PURE__*/_jsx(ChangeCenter,{position:mapPosition}),/*#__PURE__*/_jsx(DetectClick,{})]})]});}function ChangeCenter(_ref){let{position}=_ref;const map=useMap();map.setView(position);return null;}function DetectClick(){const navigate=useNavigate();useMapEvents({click:e=>navigate(\"form?lat=\".concat(e.latlng.lat,\"&lng=\").concat(e.latlng.lng))});}export default Map;","map":{"version":3,"names":["useNavigate","useSearchParams","styles","L","MapContainer","TileLayer","Marker","Popup","useMap","useMapEvents","useEffect","useState","useCities","markerIcon2x","useGeolocation","useUrlPosition","Button","jsx","_jsx","jsxs","_jsxs","Map","navigate","mapPosition","setMapPosition","cities","searchParams","setSearchParams","isLoading","isLoadingPosition","position","geolocationPosition","getPosition","mapLat","mapLng","className","mapContainer","children","type","onClick","center","zoom","scrollWheelZoom","map","attribution","url","city","lat","lng","emoji","cityName","id","ChangeCenter","DetectClick","_ref","setView","click","e","concat","latlng"],"sources":["E:/Complete Web Development/worldwise/src/components/Map.jsx"],"sourcesContent":["import { useNavigate, useSearchParams } from \"react-router-dom\";\r\nimport styles from \"./Map.module.css\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport L from \"leaflet\";\r\nimport {\r\n  MapContainer,\r\n  TileLayer,\r\n  Marker,\r\n  Popup,\r\n  useMap,\r\n  useMapEvents,\r\n} from \"react-leaflet\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useCities } from \"../contexts/CitiesContext\";\r\nimport markerIcon2x from \"leaflet/dist/images/marker-icon-2x.png\";\r\n// import { useMap } from \"react-leaflet\";\r\n\r\nimport { useGeolocation } from \"../hooks/useGeolocation\";\r\nimport { useUrlPosition } from \"../hooks/useUrlPosition\";\r\nimport Button from \"./Button\";\r\nfunction Map() {\r\n  const navigate = useNavigate();\r\n  const [mapPosition, setMapPosition] = useState([40, 0]);\r\n  const { cities } = useCities();\r\n  const [searchParams, setSearchParams] = useSearchParams();\r\n  const {\r\n    isLoading: isLoadingPosition,\r\n    position: geolocationPosition,\r\n    getPosition,\r\n  } = useGeolocation();\r\n\r\n  const [mapLat, mapLng ] = useUrlPosition();\r\n\r\n  useEffect(\r\n    function () {\r\n      if (mapLat && mapLng) setMapPosition([mapLat, mapLng]);\r\n    },\r\n    [mapLat, mapLng]\r\n  );\r\n\r\n  useEffect(\r\n    function () {\r\n      if (geolocationPosition) {\r\n        setMapPosition(geolocationPosition);\r\n      }\r\n    },\r\n    [geolocationPosition]\r\n  );\r\n\r\n  return (\r\n    <div className={styles.mapContainer}>\r\n      {!geolocationPosition && (\r\n        <Button type=\"position\" onClick={getPosition}>\r\n          {isLoadingPosition ? \"Loading...\" : \"Use your Location\"}\r\n        </Button>\r\n      )}\r\n      <MapContainer\r\n        // center={[mapLat ? mapLat : 0, mapLng ? mapLng : 0]}\r\n        center={mapPosition}\r\n        zoom={13}\r\n        scrollWheelZoom={true}\r\n        className={styles.map}\r\n      >\r\n        <TileLayer\r\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n          url=\"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png\"\r\n        />\r\n        {cities.map((city) => (\r\n          <Marker\r\n            position={[\r\n              city.position ? city.position.lat : 0,\r\n              city.position ? city.position.lng : 0,\r\n            ]}\r\n            key={city.id}\r\n          >\r\n            <Popup>\r\n              <span>{city.emoji}</span> <span>{city.cityName}</span>\r\n            </Popup>\r\n          </Marker>\r\n        ))}\r\n\r\n        <ChangeCenter position={mapPosition}></ChangeCenter>\r\n        <DetectClick />\r\n      </MapContainer>\r\n\r\n      {/* <h1>\r\n        Position: {lat}, {lng}\r\n      </h1>\r\n      <button\r\n        onClick={() => {\r\n          setSearchParams({ lat: 23, lng: 50 });\r\n        }}\r\n      >\r\n        Change Pos\r\n      </button> */}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ChangeCenter({ position }) {\r\n  const map = useMap();\r\n  map.setView(position);\r\n  return null;\r\n}\r\n\r\nfunction DetectClick() {\r\n  const navigate = useNavigate();\r\n\r\n  useMapEvents({\r\n    click: (e) => navigate(`form?lat=${e.latlng.lat}&lng=${e.latlng.lng}`),\r\n  });\r\n}\r\nexport default Map;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}